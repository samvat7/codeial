{$(document).ready((function(){$(".post-delete-btn").each((function(){n($(this))})),$(".comment-delete-btn").each((function(){a($(this))})),$(".post-likes a").each((function(){l($(this))})),$(".comment-likes a").each((function(){c($(this))})),$(".add-friend-btn").each((function(){i($(this))})),$(".remove-friend-btn").each((function(){r($(this))}))}));let e=()=>{let e=$(".new-post-form");e.on("keydown",(t=>{13==t.keyCode&&$.ajax({type:"post",url:"http://localhost:8000/posts/create",data:e.serialize(),success:function(e){let t=o(e.data.post);$(".post-list").prepend(t),n($(".post-delete-btn",t)),l($(".post-like-btn",t)),$(".new-post-form textarea").val(""),new Noty({theme:"relax",text:"Post created successfully!",type:"success",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})})),e.submit((t=>{t.preventDefault(),$.ajax({type:"post",url:"http://localhost:8000/posts/create",data:e.serialize(),success:function(e){let t=o(e.data.post);$(".post-list").prepend(t),n($(".post-delete-btn",t)),$(".new-post-form textarea").val(""),new Noty({theme:"relax",text:"Posted",type:"success",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},t=()=>{$(".post-list").on("submit",".comment-form",(function(e){e.preventDefault();let t=$(this);$.ajax({type:"post",url:"http://localhost:8000/comments/create",data:t.serialize(),success:function(e){let t=s(e.data.comment);$(`#post-comments-${e.data.comment.post._id}`).append(t),a($(".comment-delete-btn",t)),c($(".comment-like-btn",t)),$(".textarea").val(""),new Noty({theme:"relax",text:"Commented",type:"success",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},o=function(e){return $(`<div class="user-post" id="post-${e._id}">\n        <div class="post-header">\n          <p class="username">\n    \n             ${e.user.name}\n          </p>\n          \n            <a class="post-delete-btn" href="http://localhost:8000/posts/destroy/${e._id}" id="post-delete-${e._id}"\n              ><i class="fa-solid fa-trash"></i></a>\n           \n        </div>\n    \n        <p class="post-content">\n            ${e.content}\n        </p>\n\n        <div id="post-comments-${e._id}" class="post-comments">\n        </div>\n            \n              <form action="http://localhost:8000/comments/create" class="comment-form" method="post">\n    \n                <input type="text" name="content" placeholder="Type here to add comment..." class="textarea" required>\n                <input type="hidden" name="post" value="${e._id}">\n                <input type="submit" value="Comment">\n              </form>\n        \n              <div class="post-footer">\n\n              <div class="post-likes">\n      \n                <a href="http://localhost:8000/likes/toggle/?type=Post&id=${e._id}" class="post-like-btn">\n                 \n      \n                    <i class="fa-regular fa-heart"></i>\n                    \n          </a>\n                <span>0</span>\n              </div>\n      \n            </div>\n    \n      </div>`)},s=e=>$(`\n        <div class="comment" id="comment-${e._id}">\n        <div class="comment-header">\n          <p class="comment-username">\n            ${e.user.name}     \n                  <a href="http://localhost:8000/comments/destroy/${e._id}" id="comment-delete-${e._id}"\n                    class="comment-delete-btn"><i class="fa-solid fa-trash"></i></a>\n          </p>\n\n          <p class="comment-content">\n            ${e.content}\n          </p>\n\n        </div>\n        <div class="comment-footer">\n          <div class="comment-likes">\n            <a href="http://localhost:8000/likes/toggle/?type=Comment&id=${e._id}" class="comment-like-btn">\n              \n                <i class="fa-regular fa-heart"></i>\n\n            </a>\n            <span>0</span>  \n          </div>\n        </div>\n      </div>\n        `),n=()=>{$(".post-list").on("click",".post-delete-btn",(function(e){e.preventDefault();let t=$(this);$.ajax({type:"get",url:t.prop("href"),success:function(e){$(`#post-${e.data.post_id}`).remove(),new Noty({theme:"relax",text:"Post deleted",type:"success",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},a=()=>{$(".post-list").on("click",".comment-delete-btn",(function(e){e.preventDefault();let t=$(this);$.ajax({type:"get",url:t.prop("href"),success:function(e){$(`#comment-${e.data.comment_id}`).remove(),new Noty({theme:"relax",text:"Comment deleted",type:"success",timeout:1500}).show()},error:function(e){console.log(e.responseText)}})}))},l=e=>{$(e).on("click",(t=>{t.preventDefault(),$.ajax({type:"post",url:e.prop("href"),success:function(t){t.data.deleted?($(`#post-${t.data.likeableID} .post-likes a i`).remove(),$(`#post-${t.data.likeableID} .post-likes a`).append($('<i class="fa-regular fa-heart"></i>'))):($(`#post-${t.data.likeableID} .post-likes a i`).remove(),$(`#post-${t.data.likeableID} .post-likes a`).append($('<i class="fa-solid fa-heart"></i>'))),console.log(t),e.siblings("span").text(t.data.number_of_likes)},error:function(e){console.log(e.responseText)}})}))},c=e=>{$(e).on("click",(t=>{t.preventDefault(),$.ajax({type:"post",url:e.prop("href"),success:function(t){t.data.deleted?($(`#comment-${t.data.likeableID} .comment-likes a i`).remove(),$(`#comment-${t.data.likeableID} .comment-likes a`).append($('<i class="fa-regular fa-heart"></i>'))):($(`#comment-${t.data.likeableID} .comment-likes a i`).remove(),$(`#comment-${t.data.likeableID} .comment-likes a`).append($('<i class="fa-solid fa-heart"></i>'))),console.log(t),e.siblings("span").text(t.data.number_of_likes)},error:function(e){console.log(e.responseText)}})}))},i=e=>{$(e).on("click",(t=>{t.preventDefault(),console.log(e.prop("href")),$.ajax({type:"post",url:e.prop("href"),success:function(t){console.log(t),$(e).find("i").remove(),new Noty({theme:"relax",text:t.message,type:"success",timeout:1500}).show()},error:function(e){console.log("Error in add friend script",e)}})}))},r=e=>{$(e).on("click",(t=>{t.preventDefault(),console.log(e.prop("href")),$.ajax({type:"post",url:e.prop("href"),success:function(t){console.log(t),$(e).find("i").remove(),new Noty({theme:"relax",text:t.message,type:"success",timeout:1500}).show()},error:function(e){console.log("Error in remove friend script",e)}})}))};e(),t()}